# tool-arduino-data-sampler

Simple buffered data sampling Arduino tool useful for sampling at high frequencies (up to the limits of the microcontroller)

## Problem:
Logging data directly to SPI or I2C devices (such as SD card) is quite slow and a bottleneck due to write speed limits

## Solution:
Storing data directly to SRAM with a fixed size buffer is the fastest way to save data sampled at high frequencies, this library provides an easy way to do it.

The main drawback is that we have a limited buffer size restricted to the SRAM capabilities of the microcontroller.

## Example:

Plotted using [Plotly Chart Studio](https://chart-studio.plotly.com/create/#/)

<img src="https://github.com/Rafdal/tool-arduino-data-sampler/blob/main/imagen.png" alt="Sampled data plot"/>

```c++

#include <Arduino.h>

#include <DataSampler.h>

#define MAX_SAMPLES	500		// Sample list size
#define SAMPLES_PER_SEC	500	// Sampling frequency in Hertz

DataSampler<uint8_t> sampler(MAX_SAMPLES, SAMPLES_PER_SEC);

void setup()
{
	Serial.begin(115200);

	// Set read sensor callback
	sampler.setSamplerCallback([](uint8_t& value){
		value = (uint8_t)(analogRead(A0) / 4);
	});

	Serial.println(F("Starting sampler in 1 sec"));
	delay(1000);

	Serial.println(F("Running sampler..."));

	sampler.runSampler(); // Read and save all samples

	// Print all samples:	
	Serial.println();
	for (size_t i = 0; i < sampler.size(); i++)
	{
		Serial.println(sampler.getSample(i));
	}
	Serial.println();
}

void loop()
{
}
```

## Output:

```
Starting sampler in 1 sec
Running sampler...
Sampling took 1.015 seconds
With a total of 500 samples, averaging 2.0ms of time between samples

71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
72
72
73
74
78
87
95
101
106
109
111
112
112
112
101
91
86
83
81
79
77
76
76
75
75
74
74
73
73
73
73
73
73
73
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
72
71
72
72
72
72
72
71
72
72
71
71
71
71
72
71
71
71
71
71
71
71
72
72
71
72
71
71
72
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
72
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
72
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
71
```
